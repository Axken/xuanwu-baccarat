<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>百家乐玄武三式打法</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 10px; margin: 0; text-align: center; background: #fff; }
    h1 { font-size: 1.4rem; margin: 10px 0 20px; }
    .row { display: flex; justify-content: space-between; margin: 0 auto 15px; max-width: 400px; }
    .panel { display: flex; flex-direction: column; align-items: center; flex: 1; }
    .label { font-weight: bold; padding: 10px 0; width: 90%; border-radius: 8px; color: white; font-size: 1.1rem; margin-bottom: 10px; }
    .label.player { background-color: #0000ff; } .label.banker { background-color: #ff0000; }
    .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; width: 90%; }
    .grid-bottom { display: flex; justify-content: center; gap: 8px; margin-top: 5px; width: 90%; }
    .grid-bottom button { width: 33.3%; }
    .button { padding: 10px 0; font-size: 1rem; background-color: #eee; border: none; border-radius: 4px; }
    .button.active { background-color: #333; color: white; }
    .card-label { font-weight: bold; color: white; padding: 6px 20px; border-radius: 6px; font-size: 1rem; margin: 15px 0 5px; }
    .card-label.player { background-color: #0000ff; } .card-label.banker { background-color: #ff0000; }
    .card-row { display: flex; justify-content: center; gap: 20px; margin-bottom: 10px; }
    .card-row .button { padding: 12px 20px; font-size: 1.2rem; font-weight: bold; }
    .control-row { display: flex; justify-content: space-between; max-width: 400px; margin: 20px auto; gap: 10px; }
    .control-btn { flex: 1; padding: 10px 0; font-size: 1rem; font-weight: bold; color: white; border: none; border-radius: 6px; }
    .green { background-color: #2e8b57; } .blue { background-color: #3399ff; } .red { background-color: #ff4444; }
    .result-area { font-size: 1rem; margin: 10px 0; }
    .result-area .tag-xian, .result-area .tag-zhuang {
      display: inline-block; font-weight: bold; padding: 4px 12px; color: white; border-radius: 6px; font-size: 1.1rem;
    }
    .tag-zhuang { background-color: #ff0000; } .tag-xian { background-color: #0000ff; }
    ul { list-style: none; padding: 0; text-align: left; font-size: 0.95rem; max-width: 500px; margin: 0 auto; }
    li { margin-bottom: 6px; }
  </style>
</head>
<body>
  <h1>百家乐玄武三式打法</h1>
  <div class="row">
    <div class="panel">
      <div class="label player">PLAYER</div>
      <div class="grid" id="player_point_btns_top"></div>
      <div class="grid-bottom" id="player_point_btns_bottom"></div>
      <div class="card-label player">CARD</div>
      <div class="card-row" id="player_card_btns"></div>
    </div>
    <div class="panel">
      <div class="label banker">BANKER</div>
      <div class="grid" id="banker_point_btns_top"></div>
      <div class="grid-bottom" id="banker_point_btns_bottom"></div>
      <div class="card-label banker">CARD</div>
      <div class="card-row" id="banker_card_btns"></div>
    </div>
  </div>
  <div class="control-row">
    <button class="control-btn green" onclick="addRound()">ADD</button>
    <button class="control-btn blue" onclick="undo()">BACK</button>
    <button class="control-btn red" onclick="reset()">CLEAR</button>
  </div>
  <div class="result-area" id="suggestion"></div>
  <div class="result-area" id="summary"></div>
  <div style="margin-top: 10px;">
    <h3 style="text-align:left;">历史记录：</h3>
    <ul id="history"></ul>
  </div>
<script>
let selected = { player_point: 0, banker_point: 0, player_cards: 2, banker_cards: 2 };
let history = [], predictions = [], totalPredictions = 0, totalHits = 0;
const topLayout = [1, 2, 3, 4, 5, 6, 7, 8, 9], bottomLayout = [0];

function renderSplitButtons(topId, bottomId, values, key) {
  const top = document.getElementById(topId), bottom = document.getElementById(bottomId);
  top.innerHTML = ""; bottom.innerHTML = "";
  topLayout.forEach(val => {
    const btn = document.createElement("button");
    btn.className = "button" + (selected[key] === val ? " active" : "");
    btn.innerText = val; btn.onclick = () => {
      selected[key] = val; renderSplitButtons(topId, bottomId, values, key);
    }; top.appendChild(btn);
  });
  bottomLayout.forEach(val => {
    const btn = document.createElement("button");
    btn.className = "button" + (selected[key] === val ? " active" : "");
    btn.innerText = val; btn.onclick = () => {
      selected[key] = val; renderSplitButtons(topId, bottomId, values, key);
    }; bottom.appendChild(btn);
  });
}

function renderButtons(id, values, key) {
  const container = document.getElementById(id); container.innerHTML = "";
  values.forEach(val => {
    const btn = document.createElement("button");
    btn.className = "button" + (selected[key] === val ? " active" : "");
    btn.innerText = val; btn.onclick = () => {
      selected[key] = val; renderButtons(id, values, key);
    }; container.appendChild(btn);
  });
}

window.onload = () => {
  renderSplitButtons("player_point_btns_top", "player_point_btns_bottom", [...Array(10).keys()], "player_point");
  renderSplitButtons("banker_point_btns_top", "banker_point_btns_bottom", [...Array(10).keys()], "banker_point");
  renderButtons("player_card_btns", [2, 3], "player_cards");
  renderButtons("banker_card_btns", [2, 3], "banker_cards");
};

function addRound() {
  const pp = selected.player_point, bp = selected.banker_point, pc = selected.player_cards, bc = selected.banker_cards;
  let winner = "和"; if (bp > pp) winner = "庄"; else if (pp > bp) winner = "闲";
  const round = { 庄点: bp, 闲点: pp, 胜方: winner, 庄牌数: bc, 闲牌数: pc };
  history.push(round); const pred = analyze(); predictions.push(pred);
  if (predictions.length >= 2) {
    const prev = predictions[predictions.length - 2], actual = history[history.length - 1].胜方;
    if (prev.下注 !== "观望") {
      prev.命中 = (prev.下注 === actual); totalPredictions++;
      if (prev.命中) totalHits++;
    }
  }
  updateHistory();
}

function undo() { history.pop(); predictions.pop(); updateHistory(); document.getElementById("suggestion").innerHTML = ""; }

function reset() {
  history = []; predictions = []; totalHits = 0; totalPredictions = 0;
  updateHistory(); document.getElementById("suggestion").innerHTML = ""; document.getElementById("summary").innerHTML = "";
}

function updateHistory() {
  const list = document.getElementById("history"); list.innerHTML = "";
  history.forEach((h, i) => {
    const pred = predictions[i - 1]; const item = document.createElement("li");
    const winClass = h.胜方 === "庄" ? "tag-zhuang" : h.胜方 === "闲" ? "tag-xian" : "";
    let html = `局 ${i + 1} - 胜方: <span class="${winClass}">${h.胜方}</span>｜庄点: ${h.庄点}，闲点: ${h.闲点}`;
    if (pred && pred.下注 !== "观望") {
      const predClass = pred.下注 === "庄" ? "tag-zhuang" : "tag-xian";
      html += ` ｜预测: <span class="${predClass}">${pred.下注}</span>（策略${pred.策略}）`;
      html += pred.命中 === true ? " ✅" : pred.命中 === false ? " ❌" : "";
    }
    item.innerHTML = html; list.appendChild(item);
  });
  let summary = `已分析：${totalPredictions} 局 ｜ 命中：${totalHits} 局`;
  if (totalPredictions > 0) summary += ` ｜ 当前胜率：${((totalHits / totalPredictions) * 100).toFixed(1)}%`;
  document.getElementById("summary").innerHTML = summary;
}

function analyze() {
  if (history.length < 1) return { 下注: "观望", 策略: "-", 胜率: 0 };
  const last = history[history.length - 1], diff = last.庄点 - last.闲点;
  let streak = 0; for (let i = history.length - 1; i >= 0; i--) {
    if (history[i].胜方 === "庄") streak++; else break;
  }
  let suggestion = "下一局建议：<b>观望</b><br>未触发策略";
  let pred = { 下注: "观望", 策略: "-", 胜率: 0 };
  if (last.胜方 === "庄" && diff >= 3 && streak <= 2) {
    suggestion = '下一局建议：<span class="tag-zhuang">庄</span><br>触发策略：R1（预估胜率 86.2%）';
    pred = { 下注: "庄", 策略: "R1", 胜率: 86.2 };
  } else if (last.胜方 === "闲" && diff <= -2 && last.庄牌数 === 3) {
    suggestion = '下一局建议：<span class="tag-xian">闲</span><br>触发策略：R2（预估胜率 82.5%）';
    pred = { 下注: "闲", 策略: "R2", 胜率: 82.5 };
  } else if (streak === 3 && diff <= 1) {
    suggestion = '下一局建议：<span class="tag-xian">闲</span><br>触发策略：R3（预估胜率 79.4%）';
    pred = { 下注: "闲", 策略: "R3", 胜率: 79.4 };
  }
  document.getElementById("suggestion").innerHTML = suggestion;
  return pred;
}
</script>
</body>
</html>

rename to index
