<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>百家乐玄武三式打法</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #fff;
      margin: 0;
      padding:10px;
    }
    .title { font-size: 22px; margin-bottom: 15px; }
    .container { display: flex; justify-content: center; gap: 10px;}
    .column { display: flex; flex-direction: column; align-items: center;}
    .btn { padding: 8px 15px; margin: 5px; border: none; color: #fff; cursor: pointer; border-radius: 8px; }
    .player { background-color: #0000ff; }
    .banker { background-color: #ff0000; }
    .card { font-weight: bold; font-size:14px; }
    .action-btn { padding: 10px 20px; margin: 10px; font-weight: bold; border-radius: 6px; color: white; }
    .green { background-color: #4CAF50; }
    .blue { background-color: #3498DB; }
    .red { background-color: #E74C3C; }
    .history { text-align: left; margin: 10px auto; max-width: 300px; }
    .active {background-color: #555 !important; color: #fff;}
    .num-btn{
      width:40px; height:40px;
      font-size:16px; margin:2px;
      border-radius:4px; border:none;
      cursor:pointer;
      background-color:#f0f0f0;
    }
    .result-player { background: #0000ff; color: #fff; padding: 3px 8px; border-radius: 5px; }
    .result-banker { background: #ff0000; color: #fff; padding: 3px 8px; border-radius: 5px; }
    .suggestion{color:#fff;padding:3px 8px;border-radius:5px;font-weight:bold;}
  </style>
</head>
<body>

<div class="title">百家乐玄武三式打法</div>

<div class="container">
  <div class="column">
    <div class="btn player">闲家</div>
    <div id="playerPoints">
      <button class="num-btn" onclick="setPoint('闲',1,this)">1</button>
      <button class="num-btn" onclick="setPoint('闲',2,this)">2</button>
      <button class="num-btn" onclick="setPoint('闲',3,this)">3</button><br>
      <button class="num-btn" onclick="setPoint('闲',4,this)">4</button>
      <button class="num-btn" onclick="setPoint('闲',5,this)">5</button>
      <button class="num-btn" onclick="setPoint('闲',6,this)">6</button><br>
      <button class="num-btn" onclick="setPoint('闲',7,this)">7</button>
      <button class="num-btn" onclick="setPoint('闲',8,this)">8</button>
      <button class="num-btn" onclick="setPoint('闲',9,this)">9</button><br>
      <button class="num-btn" onclick="setPoint('闲',0,this)">0</button>
    </div>
    <div class="btn player card">闲牌数</div>
    <button class="num-btn" onclick="setCard('闲',2,this)">2</button>
    <button class="num-btn" onclick="setCard('闲',3,this)">3</button>
  </div>

  <div class="column">
    <div class="btn banker">庄家</div>
    <div id="bankerPoints">
      <button class="num-btn" onclick="setPoint('庄',1,this)">1</button>
      <button class="num-btn" onclick="setPoint('庄',2,this)">2</button>
      <button class="num-btn" onclick="setPoint('庄',3,this)">3</button><br>
      <button class="num-btn" onclick="setPoint('庄',4,this)">4</button>
      <button class="num-btn" onclick="setPoint('庄',5,this)">5</button>
      <button class="num-btn" onclick="setPoint('庄',6,this)">6</button><br>
      <button class="num-btn" onclick="setPoint('庄',7,this)">7</button>
      <button class="num-btn" onclick="setPoint('庄',8,this)">8</button>
      <button class="num-btn" onclick="setPoint('庄',9,this)">9</button><br>
      <button class="num-btn" onclick="setPoint('庄',0,this)">0</button>
    </div>
    <div class="btn banker card">庄牌数</div>
    <button class="num-btn" onclick="setCard('庄',2,this)">2</button>
    <button class="num-btn" onclick="setCard('庄',3,this)">3</button>
  </div>
</div>

<button class="action-btn green" onclick="addRound()">添加本局</button>
<button class="action-btn blue" onclick="undo()">撤销上局</button>
<button class="action-btn red" onclick="reset()">清空重置</button>

<div id="suggestion" style="margin-top: 10px; font-size:16px;"></div>
<div class="history" id="history"></div>

<script>
let rounds=[],current={闲:null,庄:null,闲牌:2,庄牌:2};

function setPoint(side,num,btn){
  current[side]=num;
  [...btn.parentNode.children].forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
}
function setCard(side,num,btn){
  current[side+'牌']=num;
  [...btn.parentNode.children].forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
}

function addRound(){
  if(current.闲==null||current.庄==null)return alert("请选择庄闲点数");
  rounds.push({...current,winner:current.庄>current.闲?'庄':(current.庄<current.闲?'闲':'和')});
  analyze(); current={闲:null,庄:null,闲牌:2,庄牌:2};
  document.querySelectorAll('.num-btn').forEach(b=>b.classList.remove('active'));
}

function undo(){ rounds.pop(); analyze(); }
function reset(){ rounds=[]; analyze(); }

function analyze(){
  let hits=0,html='';
  rounds.forEach((r,i)=>{
    let prediction=i?predict(i):'观望';
    let correct=(prediction==r.winner);
    if(i>0&&correct)hits++;
    html+=`局${i+1}: 胜方: <span class="${r.winner=='庄'?'result-banker':'result-player'}">${r.winner}</span>, 庄:${r.庄}, 闲:${r.闲}${i>0?` 预测:<span class="${prediction=='庄'?'result-banker':'result-player'}">${prediction}</span> ${correct?'✔️':'❌'}`:''}<br>`;
  });
  let rate=((hits/(rounds.length-1))*100||0).toFixed(1);
  document.getElementById('history').innerHTML=html;
  let sug=predict(rounds.length);
  document.getElementById('suggestion').innerHTML=`下一局建议: <span class="suggestion ${sug=='庄'?'banker':'player'}">${sug}</span><br>分析: ${rounds.length-1}局, 命中:${hits}局, 胜率:${rate}%`;
}

function predict(i){
  if(i<1)return'观望';
  let last=rounds[i-1],diff=last.庄-last.闲,streak=streakCount(i-1,last.winner);
  if(last.winner=='庄'&&streak>=3&&diff>=3)return'庄';
  if(i>=2&&rounds[i-2].winner=='闲'&&last.winner=='庄'&&Math.abs(diff)<=2)return'闲';
  if(streak<=2&&Math.abs(diff)<=1)return last.winner=='庄'?'闲':'庄';
  return '观望';
}

function streakCount(i,winner){
  let c=0;for(let j=i;j>=0;j--)if(rounds[j].winner==winner)c++;else break;return c;
}
analyze();
</script>

</body>
</html>
